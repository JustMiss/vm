"use strict";!function(c){function d(e,i,n){var t=new Date;t.setDate(t.getDate()+n),document.cookie=e+"="+encodeURIComponent(i)+";expires="+t}function e(e){var i=decodeURIComponent(document.cookie).split("; "),n=!0,t=!1,c=void 0;try{for(var d,a=i[Symbol.iterator]();!(n=(d=a.next()).done);n=!0){var s=d.value.split("=");if(e===s[0])return s[1]}}catch(e){t=!0,c=e}finally{try{!n&&a.return&&a.return()}finally{if(t)throw c}}}var a=[],s=[];function l(){var n=0,t=0;c(".check_single:visible").each(function(e,i){c(i).find(".checked").hasClass("checked_ed")&&(n+=parseInt(c(i).find(".cm_num").find("input").val()),t+=parseFloat(c(i).find(".a_price").find("em").html()))}),c(".all_price").find("em").html(n),c(".all_price").find("span").html("￥"+t.toFixed(2))}e("commoditytype")&&(a=e("commoditytype").split(","),s=e("commoditynum").split(",")),e("username")?c(".if_login").hide():c(".if_login").show(),c.each(a,function(n,e){c.ajax({type:"get",url:"http://localhost/August/project/php/getDetail.php",data:{sid:e},dataType:"json"}).done(function(e){var i=c(".check_single:hidden").clone(!0,!0);i.find("img").attr("src",e.src),i.find("img").attr("sid",e.sid),i.find(".c_d_first").html(e.titile),i.find(".s_price").find("span").html(e.price),i.find(".cm_num").find("input").val(s[n]),i.find(".a_price").find("em").html((e.price*s[n]).toFixed(2)),i.css("display","block"),c(".c_detaillist").append(i),l()})}),c(".cm_num .cm_reduce").on("click",function(){var e=c(this).parent().find("input").val();--e<=1&&(e=1),c(this).parent().find("input").val(e);var i=c(this).parents(".single_detail").find("img").attr("sid"),n=a.indexOf(i);s[n]=e,d("commoditynum",s);var t=parseInt(c(this).parents(".single_detail").find(".s_price span").html());c(this).parents(".single_detail").find(".a_price").find("em").html((t*e).toFixed(2)),l()}),c(".cm_num .cm_add").on("click",function(){var e=c(this).parent().find("input").val();e++,c(this).parent().find("input").val(e);var i=c(this).parents(".single_detail").find("img").attr("sid"),n=a.indexOf(i);s[n]=e,d("commoditynum",s);var t=parseInt(c(this).parents(".single_detail").find(".s_price span").html());c(this).parents(".single_detail").find(".a_price").find("em").html((t*e).toFixed(2)),l()}),c(".check_single .cm_num").find("input").on("input",function(){var e=c(this).parent().find("input").val(),i=c(this).parents(".single_detail").find("img").attr("sid"),n=a.indexOf(i);s[n]=e,d("commoditynum",s);var t=parseInt(c(this).parents(".single_detail").find(".s_price span").html());c(this).parents(".single_detail").find(".a_price").find("em").html((t*e).toFixed(2)),l()}),c(".all_check .checked").on("click",function(){c(this).toggleClass("checked_ed"),c(this).hasClass("checked_ed")?c(".checkbox .checked").each(function(e,i){c(i).addClass("checked_ed")}):c(".checkbox .checked").each(function(e,i){c(i).removeClass("checked_ed")}),l()}),c(".check_single .checked").on("click",function(){c(this).toggleClass("checked_ed"),c(".check_single:visible").length===c(".check_single .checked_ed").length-1?c(".all_check .checked").each(function(e,i){c(i).addClass("checked_ed")}):c(".all_check .checked").each(function(e,i){c(i).removeClass("checked_ed")}),l()}),c(".delcm i").on("click",function(){if(confirm("你确定要删除吗")){var e=c(this).parents(".single_detail").find("img").attr("sid");a.splice(e,1),s.splice(e,1),d("commoditytype",a),d("commoditynum",s),c(this).parents(".check_single").hide()}})}(jQuery);